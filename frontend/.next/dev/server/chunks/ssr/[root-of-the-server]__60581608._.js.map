{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 82, "column": 0}, "map": {"version":3,"sources":["file:///C:/desesonpro/desewebv5/frontend/src/utils/logger.ts"],"sourcesContent":["/**\r\n * Frontend logger utility\r\n * Provides structured logging for the frontend application\r\n */\r\n\r\ntype LogLevel = 'debug' | 'info' | 'warn' | 'error';\r\n\r\ninterface LogContext {\r\n  [key: string]: unknown;\r\n}\r\n\r\nclass Logger {\r\n  private isDevelopment(): boolean {\r\n    return process.env.NODE_ENV === 'development';\r\n  }\r\n\r\n  private formatMessage(level: LogLevel, message: string, context?: LogContext): string {\r\n    const timestamp = new Date().toISOString();\r\n    const contextStr = context ? ` ${JSON.stringify(context)}` : '';\r\n    return `[${timestamp}] [${level.toUpperCase()}] ${message}${contextStr}`;\r\n  }\r\n\r\n  private log(level: LogLevel, message: string, context?: LogContext): void {\r\n    if (!this.isDevelopment() && level === 'debug') {\r\n      return; // Skip debug logs in production\r\n    }\r\n\r\n    const formattedMessage = this.formatMessage(level, message, context);\r\n\r\n    switch (level) {\r\n      case 'debug':\r\n        // eslint-disable-next-line no-console\r\n        console.debug(formattedMessage);\r\n        break;\r\n      case 'info':\r\n        // eslint-disable-next-line no-console\r\n        console.info(formattedMessage);\r\n        break;\r\n      case 'warn':\r\n        // eslint-disable-next-line no-console\r\n        console.warn(formattedMessage);\r\n        break;\r\n      case 'error':\r\n        // For errors, use console.error but format to reduce stack trace noise\r\n        // Pass context as second parameter to avoid showing logger's stack trace\r\n        if (context && Object.keys(context).length > 0) {\r\n          // eslint-disable-next-line no-console\r\n          console.error(`%c${formattedMessage}`, 'color: red; font-weight: bold;', context);\r\n        } else {\r\n          // eslint-disable-next-line no-console\r\n          console.error(`%c${formattedMessage}`, 'color: red; font-weight: bold;');\r\n        }\r\n        break;\r\n    }\r\n  }\r\n\r\n  debug(message: string, context?: LogContext): void {\r\n    this.log('debug', message, context);\r\n  }\r\n\r\n  info(message: string, context?: LogContext): void {\r\n    this.log('info', message, context);\r\n  }\r\n\r\n  warn(message: string, context?: LogContext): void {\r\n    this.log('warn', message, context);\r\n  }\r\n\r\n  error(message: string, context?: LogContext): void {\r\n    this.log('error', message, context);\r\n  }\r\n\r\n  /**\r\n   * Grouped logging for development (e.g., error details)\r\n   */\r\n  group(title: string, logs: () => void): void {\r\n    if (this.isDevelopment()) {\r\n      // eslint-disable-next-line no-console\r\n      console.group(title);\r\n      logs();\r\n      // eslint-disable-next-line no-console\r\n      console.groupEnd();\r\n    } else {\r\n      // In production, just execute the logs without grouping\r\n      logs();\r\n    }\r\n  }\r\n}\r\n\r\nexport const logger = new Logger();\r\n\r\n"],"names":[],"mappings":"AAAA;;;CAGC;;;;AAQD,MAAM;IACI,gBAAyB;QAC/B,OAAO,oDAAyB;IAClC;IAEQ,cAAc,KAAe,EAAE,OAAe,EAAE,OAAoB,EAAU;QACpF,MAAM,YAAY,IAAI,OAAO,WAAW;QACxC,MAAM,aAAa,UAAU,CAAC,CAAC,EAAE,KAAK,SAAS,CAAC,UAAU,GAAG;QAC7D,OAAO,CAAC,CAAC,EAAE,UAAU,GAAG,EAAE,MAAM,WAAW,GAAG,EAAE,EAAE,UAAU,YAAY;IAC1E;IAEQ,IAAI,KAAe,EAAE,OAAe,EAAE,OAAoB,EAAQ;QACxE,IAAI,CAAC,IAAI,CAAC,aAAa,MAAM,UAAU,SAAS;YAC9C,QAAQ,gCAAgC;QAC1C;QAEA,MAAM,mBAAmB,IAAI,CAAC,aAAa,CAAC,OAAO,SAAS;QAE5D,OAAQ;YACN,KAAK;gBACH,sCAAsC;gBACtC,QAAQ,KAAK,CAAC;gBACd;YACF,KAAK;gBACH,sCAAsC;gBACtC,QAAQ,IAAI,CAAC;gBACb;YACF,KAAK;gBACH,sCAAsC;gBACtC,QAAQ,IAAI,CAAC;gBACb;YACF,KAAK;gBACH,uEAAuE;gBACvE,yEAAyE;gBACzE,IAAI,WAAW,OAAO,IAAI,CAAC,SAAS,MAAM,GAAG,GAAG;oBAC9C,sCAAsC;oBACtC,QAAQ,KAAK,CAAC,CAAC,EAAE,EAAE,kBAAkB,EAAE,kCAAkC;gBAC3E,OAAO;oBACL,sCAAsC;oBACtC,QAAQ,KAAK,CAAC,CAAC,EAAE,EAAE,kBAAkB,EAAE;gBACzC;gBACA;QACJ;IACF;IAEA,MAAM,OAAe,EAAE,OAAoB,EAAQ;QACjD,IAAI,CAAC,GAAG,CAAC,SAAS,SAAS;IAC7B;IAEA,KAAK,OAAe,EAAE,OAAoB,EAAQ;QAChD,IAAI,CAAC,GAAG,CAAC,QAAQ,SAAS;IAC5B;IAEA,KAAK,OAAe,EAAE,OAAoB,EAAQ;QAChD,IAAI,CAAC,GAAG,CAAC,QAAQ,SAAS;IAC5B;IAEA,MAAM,OAAe,EAAE,OAAoB,EAAQ;QACjD,IAAI,CAAC,GAAG,CAAC,SAAS,SAAS;IAC7B;IAEA;;GAEC,GACD,MAAM,KAAa,EAAE,IAAgB,EAAQ;QAC3C,IAAI,IAAI,CAAC,aAAa,IAAI;YACxB,sCAAsC;YACtC,QAAQ,KAAK,CAAC;YACd;YACA,sCAAsC;YACtC,QAAQ,QAAQ;QAClB,OAAO;YACL,wDAAwD;YACxD;QACF;IACF;AACF;AAEO,MAAM,SAAS,IAAI","debugId":null}},
    {"offset": {"line": 161, "column": 0}, "map": {"version":3,"sources":["file:///C:/desesonpro/desewebv5/frontend/src/api/client.ts"],"sourcesContent":["import axios, { AxiosError, AxiosRequestConfig, InternalAxiosRequestConfig } from \"axios\";\r\nimport { logger } from \"@/utils/logger\";\r\n\r\nexport interface ApiError {\r\n  error: string;\r\n  message: string;\r\n  details?: {\r\n    issues?: Array<{\r\n      field: string;\r\n      message: string;\r\n      code: string;\r\n    }>;\r\n  };\r\n  timestamp?: string;\r\n  path?: string;\r\n}\r\n\r\n// Create axios instance with default config\r\nconst getBaseURL = () => {\r\n  // In development, use full URL if NEXT_PUBLIC_API_URL is set\r\n  if (typeof window !== \"undefined\" && process.env.NEXT_PUBLIC_API_URL) {\r\n    return process.env.NEXT_PUBLIC_API_URL;\r\n  }\r\n  // Default to backend port 3001 in development\r\n  return typeof window !== \"undefined\" \r\n    ? process.env.NODE_ENV === 'development'\r\n      ? \"http://localhost:3001/api/v1\"\r\n      : `${window.location.protocol}//${window.location.host}/api/v1`\r\n    : \"/api/v1\";\r\n};\r\n\r\nexport const api = axios.create({\r\n  baseURL: getBaseURL(),\r\n  timeout: 15000,\r\n  headers: {\r\n    \"Content-Type\": \"application/json\",\r\n  },\r\n});\r\n\r\n// Request interceptor - Add auth token and dev headers\r\napi.interceptors.request.use(\r\n  (config: InternalAxiosRequestConfig) => {\r\n    // Add dev mode header for CLI authentication bypass\r\n    if (typeof window !== \"undefined\" && process.env.NODE_ENV === \"development\") {\r\n      if (config.headers) {\r\n        config.headers[\"X-Master-Control-CLI\"] = \"true\";\r\n      }\r\n    }\r\n\r\n    const token = localStorage.getItem(\"token\");\r\n    if (token && config.headers) {\r\n      config.headers.Authorization = `Bearer ${token}`;\r\n    }\r\n    return config;\r\n  },\r\n  (error) => {\r\n    return Promise.reject(error);\r\n  }\r\n);\r\n\r\n// Response interceptor - Handle errors globally\r\napi.interceptors.response.use(\r\n  (response) => {\r\n    return response;\r\n  },\r\n  async (error: AxiosError<ApiError>) => {\r\n    const originalRequest = error.config as InternalAxiosRequestConfig & {\r\n      _retry?: boolean;\r\n    };\r\n\r\n    // Handle 401 Unauthorized - Token expired or invalid\r\n    if (error.response?.status === 401 && !originalRequest._retry) {\r\n      originalRequest._retry = true;\r\n\r\n      logger.warn(\"Authentication Error: Token expired or invalid. Redirecting to login...\", {\r\n        url: originalRequest?.url,\r\n        method: originalRequest?.method,\r\n      });\r\n\r\n      // Clear token and redirect to login\r\n      if (typeof window !== \"undefined\") {\r\n        localStorage.removeItem(\"token\");\r\n        \r\n        // Only redirect if we're not already on the login page\r\n        if (!window.location.pathname.includes(\"/login\")) {\r\n          window.location.href = \"/login\";\r\n        }\r\n      }\r\n\r\n      return Promise.reject(error);\r\n    }\r\n\r\n    // Handle 403 Forbidden\r\n    if (error.response?.status === 403) {\r\n      const message = error.response.data?.message || \"Access denied\";\r\n      logger.error(\"Forbidden\", {\r\n        message,\r\n        url: originalRequest?.url,\r\n        method: originalRequest?.method,\r\n      });\r\n      // Could show a toast notification here\r\n    }\r\n\r\n    // Handle 429 Too Many Requests\r\n    if (error.response?.status === 429) {\r\n      const retryAfter = error.response.headers[\"retry-after\"];\r\n      const message = error.response.data?.message || \"Too many requests. Please try again later.\";\r\n      logger.warn(\"Rate limit exceeded\", {\r\n        message,\r\n        retryAfter,\r\n        url: originalRequest?.url,\r\n        method: originalRequest?.method,\r\n      });\r\n      // Could implement exponential backoff retry here\r\n    }\r\n\r\n    // Handle 500+ Server Errors with detailed logging\r\n    if (error.response?.status && error.response.status >= 500) {\r\n      const errorDetails = {\r\n        type: \"Server Error\",\r\n        status: error.response.status,\r\n        message: error.response.data?.message || \"Internal server error\",\r\n        url: originalRequest?.url,\r\n        baseURL: originalRequest?.baseURL,\r\n        method: originalRequest?.method?.toUpperCase(),\r\n        data: error.response.data,\r\n      };\r\n\r\n      logger.group(`Server Error ${errorDetails.status}`, () => {\r\n        logger.error(\"Server error occurred\", {\r\n          status: errorDetails.status,\r\n          message: errorDetails.message,\r\n          url: `${errorDetails.baseURL}${errorDetails.url}`,\r\n          method: errorDetails.method || \"N/A\",\r\n          responseData: errorDetails.data,\r\n        });\r\n      });\r\n    }\r\n\r\n    // Handle network errors with detailed logging\r\n    if (!error.response) {\r\n      const errorMessage = error.message || \"Network error\";\r\n      const fullUrl = `${originalRequest?.baseURL || ''}${originalRequest?.url || ''}`;\r\n      const errorDetails = {\r\n        type: \"Network Error\",\r\n        message: errorMessage,\r\n        code: error.code,\r\n        url: originalRequest?.url,\r\n        baseURL: originalRequest?.baseURL,\r\n        fullUrl,\r\n        method: originalRequest?.method?.toUpperCase(),\r\n      };\r\n\r\n      // Log network error with context (only in development)\r\n      // Note: Network errors are expected when backend is down, so we log them gracefully\r\n      if (process.env.NODE_ENV === \"development\") {\r\n        logger.group(\"‚ö†Ô∏è Network Error (Backend may be offline)\", () => {\r\n          logger.error(\"Request failed\", {\r\n            method: errorDetails.method,\r\n            url: errorDetails.fullUrl,\r\n            code: errorDetails.code,\r\n            message: errorDetails.message,\r\n          });\r\n          \r\n          // Provide troubleshooting tips for common network errors\r\n          if (error.code === \"ECONNREFUSED\" || errorMessage.includes(\"Network Error\") || error.code === \"ERR_NETWORK\") {\r\n            logger.warn(\"üí° Troubleshooting\", {\r\n              currentBaseURL: getBaseURL(),\r\n              configuredApiUrl: process.env.NEXT_PUBLIC_API_URL || \"not set\",\r\n              check: [\r\n                \"‚úì Backend server running on http://localhost:3001?\",\r\n                \"‚úì Docker containers (PostgreSQL, Redis) running?\",\r\n                \"‚úì CORS configured correctly?\",\r\n                \"‚úì NEXT_PUBLIC_API_URL set correctly?\",\r\n              ],\r\n            });\r\n          }\r\n        });\r\n      } else {\r\n        // In production, log more concisely\r\n        logger.error(\"Network request failed\", {\r\n          code: error.code,\r\n          url: originalRequest?.url,\r\n        });\r\n      }\r\n    }\r\n\r\n    return Promise.reject(error);\r\n  }\r\n);\r\n\r\n// Helper function to extract error message\r\nexport function getErrorMessage(error: unknown): string {\r\n  if (axios.isAxiosError<ApiError>(error)) {\r\n    if (error.response?.data?.message) {\r\n      return error.response.data.message;\r\n    }\r\n    if (error.response?.data?.error) {\r\n      return error.response.data.error;\r\n    }\r\n    if (error.message) {\r\n      return error.message;\r\n    }\r\n  }\r\n  if (error instanceof Error) {\r\n    return error.message;\r\n  }\r\n  return \"An unexpected error occurred\";\r\n}\r\n\r\n// Helper function to extract validation errors\r\nexport function getValidationErrors(error: unknown): Array<{ field: string; message: string }> {\r\n  if (axios.isAxiosError<ApiError>(error)) {\r\n    return error.response?.data?.details?.issues?.map((issue) => ({\r\n      field: issue.field,\r\n      message: issue.message,\r\n    })) || [];\r\n  }\r\n  return [];\r\n}\r\n\r\n// Retry helper for failed requests\r\nexport async function retryRequest<T>(\r\n  requestFn: () => Promise<T>,\r\n  maxRetries: number = 3,\r\n  delay: number = 1000\r\n): Promise<T> {\r\n  let lastError: unknown;\r\n\r\n  for (let attempt = 1; attempt <= maxRetries; attempt++) {\r\n    try {\r\n      return await requestFn();\r\n    } catch (error) {\r\n      lastError = error;\r\n\r\n      // Don't retry on 4xx errors (except 429)\r\n      if (axios.isAxiosError(error) && error.response?.status) {\r\n        const status = error.response.status;\r\n        if (status >= 400 && status < 500 && status !== 429) {\r\n          throw error; // Don't retry client errors\r\n        }\r\n      }\r\n\r\n      if (attempt < maxRetries) {\r\n        const backoffDelay = delay * Math.pow(2, attempt - 1); // Exponential backoff\r\n        await new Promise((resolve) => setTimeout(resolve, backoffDelay));\r\n      }\r\n    }\r\n  }\r\n\r\n  throw lastError;\r\n}\r\n\r\n// API methods with proper typing\r\nexport const apiMethods = {\r\n  get: <T = any>(url: string, config?: AxiosRequestConfig) =>\r\n    api.get<T>(url, config).then((res) => res.data),\r\n\r\n  post: <T = any>(url: string, data?: any, config?: AxiosRequestConfig) =>\r\n    api.post<T>(url, data, config).then((res) => res.data),\r\n\r\n  put: <T = any>(url: string, data?: any, config?: AxiosRequestConfig) =>\r\n    api.put<T>(url, data, config).then((res) => res.data),\r\n\r\n  patch: <T = any>(url: string, data?: any, config?: AxiosRequestConfig) =>\r\n    api.patch<T>(url, data, config).then((res) => res.data),\r\n\r\n  delete: <T = any>(url: string, config?: AxiosRequestConfig) =>\r\n    api.delete<T>(url, config).then((res) => res.data),\r\n};\r\n\r\n// Export default api for backward compatibility\r\nexport default api;\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 369, "column": 0}, "map": {"version":3,"sources":["file:///C:/desesonpro/desewebv5/frontend/src/components/aiops/DriftPanel.tsx"],"sourcesContent":["\"use client\";\r\nimport { useEffect, useState, useRef } from \"react\";\r\nimport { api } from \"@/api/client\";\r\nimport { getErrorMessage } from \"@/api/client\";\r\n\r\ninterface TelemetryData {\r\n  timestamp: number;\r\n  avgLatency: number;\r\n  drift: boolean;\r\n  metrics: {\r\n    avgLatency: number;\r\n    predictedLatency: number;\r\n    driftPercentage: number;\r\n  };\r\n}\r\n\r\nexport default function DriftPanel() {\r\n  const [drift, setDrift] = useState(false);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [data, setData] = useState<TelemetryData | null>(null);\r\n  const retryCountRef = useRef(0);\r\n  const intervalRef = useRef<NodeJS.Timeout | null>(null);\r\n\r\n  useEffect(() => {\r\n    const fetchData = async () => {\r\n      try {\r\n        setLoading(true);\r\n        setError(null);\r\n        const response = await api.get<{ success: boolean; data?: TelemetryData }>(\"/aiops/collect\");\r\n        const result = response.data;\r\n        \r\n        if (result.success && result.data) {\r\n          const telemetryData = result.data;\r\n          setData(telemetryData);\r\n          setDrift(telemetryData.drift);\r\n          retryCountRef.current = 0; // Reset retry count on success\r\n        }\r\n      } catch (err: unknown) {\r\n        const errorMessage = getErrorMessage(err);\r\n        console.error(\"Error fetching AIOps data:\", err);\r\n        \r\n        // Handle 429 (Too Many Requests) with exponential backoff\r\n        if (errorMessage.includes('429') || errorMessage.includes('Too Many Requests')) {\r\n          retryCountRef.current += 1;\r\n          const backoffDelay = Math.min(300000, 60000 * Math.pow(2, retryCountRef.current)); // Max 5 minutes\r\n          \r\n          setError(`Rate limit exceeded. Retrying in ${Math.round(backoffDelay / 1000)}s...`);\r\n          \r\n          // Clear existing interval\r\n          if (intervalRef.current) {\r\n            clearInterval(intervalRef.current);\r\n            intervalRef.current = null;\r\n          }\r\n          \r\n          // Schedule retry with exponential backoff\r\n          setTimeout(() => {\r\n            fetchData();\r\n            // Resume normal polling after successful retry\r\n            if (!intervalRef.current) {\r\n              intervalRef.current = setInterval(fetchData, 120000); // 2 minutes instead of 1\r\n            }\r\n          }, backoffDelay);\r\n          \r\n          setLoading(false); // Allow UI to show error state\r\n          return;\r\n        } else {\r\n          setError(errorMessage);\r\n          retryCountRef.current = 0;\r\n        }\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    // Initial fetch\r\n    fetchData();\r\n\r\n    // Poll every 2 minutes (reduced from 1 minute to avoid rate limiting)\r\n    intervalRef.current = setInterval(fetchData, 120000);\r\n\r\n    return () => {\r\n      if (intervalRef.current) {\r\n        clearInterval(intervalRef.current);\r\n      }\r\n    };\r\n  }, []);\r\n\r\n  if (loading && !data) {\r\n    return (\r\n      <div className=\"p-4 rounded bg-gray-100 animate-pulse\">\r\n        <h2 className=\"font-bold text-lg\">AIOps Drift Monitor</h2>\r\n        <p>Loading...</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div\r\n      className={`p-4 rounded ${\r\n        drift ? \"bg-red-200 border-2 border-red-500\" : \"bg-green-200 border-2 border-green-500\"\r\n      }`}\r\n    >\r\n      <div className=\"flex items-center justify-between\">\r\n        <div>\r\n          <h2 className=\"font-bold text-lg\">AIOps Drift Monitor</h2>\r\n          <p className={`font-semibold ${drift ? \"text-red-700\" : \"text-green-700\"}`}>\r\n            {drift ? \"‚ö†Ô∏è Drift Detected\" : \"‚úÖ Stable\"}\r\n          </p>\r\n          {error && (\r\n            <p className=\"text-xs text-orange-600 mt-1\">{error}</p>\r\n          )}\r\n        </div>\r\n        {drift && (\r\n          <span className=\"text-2xl animate-pulse\">‚ö†Ô∏è</span>\r\n        )}\r\n      </div>\r\n\r\n      {data && (\r\n        <div className=\"mt-4 space-y-2 text-sm\">\r\n          <div className=\"flex justify-between\">\r\n            <span className=\"text-gray-600\">Avg Latency:</span>\r\n            <span className=\"font-mono\">{data.avgLatency.toFixed(3)}s</span>\r\n          </div>\r\n          <div className=\"flex justify-between\">\r\n            <span className=\"text-gray-600\">Predicted:</span>\r\n            <span className=\"font-mono\">{data.metrics.predictedLatency.toFixed(3)}s</span>\r\n          </div>\r\n          <div className=\"flex justify-between\">\r\n            <span className=\"text-gray-600\">Drift %:</span>\r\n            <span className={`font-mono ${Math.abs(data.metrics.driftPercentage) > 5 ? \"text-red-600\" : \"text-green-600\"}`}>\r\n              {data.metrics.driftPercentage > 0 ? \"+\" : \"\"}\r\n              {data.metrics.driftPercentage.toFixed(2)}%\r\n            </span>\r\n          </div>\r\n          <div className=\"flex justify-between text-xs text-gray-500 mt-2\">\r\n            <span>Last update:</span>\r\n            <span>{new Date(data.timestamp).toLocaleTimeString()}</span>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 648, "column": 0}, "map": {"version":3,"sources":["file:///C:/desesonpro/desewebv5/frontend/src/components/aiops/InsightsPanel.tsx"],"sourcesContent":["\"use client\";\r\nimport { useState, useEffect } from \"react\";\r\nimport { apiMethods, getErrorMessage } from \"@/api/client\";\r\n\r\ninterface FeedbackEntry {\r\n  timestamp: number;\r\n  metric: string;\r\n  anomaly: boolean;\r\n  verdict: boolean;\r\n  comment: string;\r\n}\r\n\r\ninterface FeedbackResponse {\r\n  success: boolean;\r\n  count: number;\r\n  feedback: FeedbackEntry[];\r\n}\r\n\r\nexport default function InsightsPanel() {\r\n  const [feedback, setFeedback] = useState<FeedbackEntry[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  useEffect(() => {\r\n    const fetchData = async () => {\r\n      try {\r\n        setLoading(true);\r\n        const data = await apiMethods.get<FeedbackResponse>(\"/aiops/feedback\");\r\n        if (data.success) {\r\n          setFeedback(data.feedback);\r\n        }\r\n      } catch (err) {\r\n        setError(getErrorMessage(err));\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    fetchData();\r\n    // Refresh every 30 seconds\r\n    const intervalId = setInterval(fetchData, 30000);\r\n    return () => clearInterval(intervalId);\r\n  }, []);\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"p-4 border rounded-lg bg-gray-50\">\r\n        <h2 className=\"font-bold text-lg mb-2\">AIOps Insights</h2>\r\n        <p className=\"text-gray-500\">Loading...</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (error) {\r\n    return (\r\n      <div className=\"p-4 border rounded-lg bg-red-50\">\r\n        <h2 className=\"font-bold text-lg mb-2\">AIOps Insights</h2>\r\n        <p className=\"text-red-600\">Error: {error}</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"p-4 border rounded-lg bg-white\">\r\n      <div className=\"flex items-center justify-between mb-4\">\r\n        <h2 className=\"font-bold text-lg\">AIOps Insights</h2>\r\n        {feedback.length > 0 && (\r\n          <span className=\"text-sm text-gray-500\">\r\n            {feedback.length} {feedback.length === 1 ? \"entry\" : \"entries\"}\r\n          </span>\r\n        )}\r\n      </div>\r\n\r\n      {feedback.length === 0 ? (\r\n        <p className=\"text-gray-500\">No feedback yet.</p>\r\n      ) : (\r\n        <div className=\"space-y-3 max-h-96 overflow-y-auto\">\r\n          {feedback\r\n            .slice()\r\n            .reverse()\r\n            .map((f, i) => (\r\n              <div\r\n                key={i}\r\n                className=\"p-3 border-b last:border-b-0 bg-gray-50 rounded hover:bg-gray-100 transition-colors\"\r\n              >\r\n                <div className=\"flex items-start justify-between mb-2\">\r\n                  <div className=\"flex-1\">\r\n                    <p className=\"font-semibold text-gray-900 mb-1\">\r\n                      {f.metric}\r\n                    </p>\r\n                    <div className=\"flex items-center gap-2 text-sm\">\r\n                      <span\r\n                        className={`px-2 py-1 rounded ${\r\n                          f.verdict\r\n                            ? \"bg-green-200 text-green-800\"\r\n                            : \"bg-red-200 text-red-800\"\r\n                        }`}\r\n                      >\r\n                        {f.verdict ? \"‚úÖ True\" : \"‚ùå False\"}\r\n                      </span>\r\n                      {f.anomaly && (\r\n                        <span className=\"px-2 py-1 rounded bg-orange-200 text-orange-800\">\r\n                          ‚ö†Ô∏è Anomaly\r\n                        </span>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                  <span className=\"text-xs text-gray-500 ml-2\">\r\n                    {new Date(f.timestamp).toLocaleTimeString()}\r\n                  </span>\r\n                </div>\r\n                {f.comment && (\r\n                  <p className=\"text-sm text-gray-600 mt-2 italic\">\r\n                    \"{f.comment}\"\r\n                  </p>\r\n                )}\r\n              </div>\r\n            ))}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AACA;AACA;AAFA;;;;AAkBe,SAAS;IACtB,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,6NAAQ,EAAkB,EAAE;IAC5D,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,6NAAQ,EAAC;IACvC,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,6NAAQ,EAAgB;IAElD,IAAA,8NAAS,EAAC;QACR,MAAM,YAAY;YAChB,IAAI;gBACF,WAAW;gBACX,MAAM,OAAO,MAAM,8IAAU,CAAC,GAAG,CAAmB;gBACpD,IAAI,KAAK,OAAO,EAAE;oBAChB,YAAY,KAAK,QAAQ;gBAC3B;YACF,EAAE,OAAO,KAAK;gBACZ,SAAS,IAAA,mJAAe,EAAC;YAC3B,SAAU;gBACR,WAAW;YACb;QACF;QAEA;QACA,2BAA2B;QAC3B,MAAM,aAAa,YAAY,WAAW;QAC1C,OAAO,IAAM,cAAc;IAC7B,GAAG,EAAE;IAEL,IAAI,SAAS;QACX,qBACE,0PAAC;YAAI,WAAU;;8BACb,0PAAC;oBAAG,WAAU;8BAAyB;;;;;;8BACvC,0PAAC;oBAAE,WAAU;8BAAgB;;;;;;;;;;;;IAGnC;IAEA,IAAI,OAAO;QACT,qBACE,0PAAC;YAAI,WAAU;;8BACb,0PAAC;oBAAG,WAAU;8BAAyB;;;;;;8BACvC,0PAAC;oBAAE,WAAU;;wBAAe;wBAAQ;;;;;;;;;;;;;IAG1C;IAEA,qBACE,0PAAC;QAAI,WAAU;;0BACb,0PAAC;gBAAI,WAAU;;kCACb,0PAAC;wBAAG,WAAU;kCAAoB;;;;;;oBACjC,SAAS,MAAM,GAAG,mBACjB,0PAAC;wBAAK,WAAU;;4BACb,SAAS,MAAM;4BAAC;4BAAE,SAAS,MAAM,KAAK,IAAI,UAAU;;;;;;;;;;;;;YAK1D,SAAS,MAAM,KAAK,kBACnB,0PAAC;gBAAE,WAAU;0BAAgB;;;;;qCAE7B,0PAAC;gBAAI,WAAU;0BACZ,SACE,KAAK,GACL,OAAO,GACP,GAAG,CAAC,CAAC,GAAG,kBACP,0PAAC;wBAEC,WAAU;;0CAEV,0PAAC;gCAAI,WAAU;;kDACb,0PAAC;wCAAI,WAAU;;0DACb,0PAAC;gDAAE,WAAU;0DACV,EAAE,MAAM;;;;;;0DAEX,0PAAC;gDAAI,WAAU;;kEACb,0PAAC;wDACC,WAAW,CAAC,kBAAkB,EAC5B,EAAE,OAAO,GACL,gCACA,2BACJ;kEAED,EAAE,OAAO,GAAG,WAAW;;;;;;oDAEzB,EAAE,OAAO,kBACR,0PAAC;wDAAK,WAAU;kEAAkD;;;;;;;;;;;;;;;;;;kDAMxE,0PAAC;wCAAK,WAAU;kDACb,IAAI,KAAK,EAAE,SAAS,EAAE,kBAAkB;;;;;;;;;;;;4BAG5C,EAAE,OAAO,kBACR,0PAAC;gCAAE,WAAU;;oCAAoC;oCAC7C,EAAE,OAAO;oCAAC;;;;;;;;uBA/BX;;;;;;;;;;;;;;;;AAwCrB","debugId":null}},
    {"offset": {"line": 876, "column": 0}, "map": {"version":3,"sources":["file:///C:/desesonpro/desewebv5/frontend/src/components/aiops/ReplayTimeline.tsx"],"sourcesContent":["\"use client\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { apiMethods, getErrorMessage } from \"@/api/client\";\r\n\r\ninterface RemediationEvent {\r\n  timestamp: number;\r\n  metric: string;\r\n  action: string;\r\n  severity: \"low\" | \"medium\" | \"high\";\r\n  status: \"executed\" | \"pending\" | \"failed\";\r\n}\r\n\r\ninterface ReplayResponse {\r\n  success: boolean;\r\n  count: number;\r\n  events: RemediationEvent[];\r\n}\r\n\r\nexport default function ReplayTimeline() {\r\n  const [events, setEvents] = useState<RemediationEvent[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  useEffect(() => {\r\n    const fetchData = async () => {\r\n      try {\r\n        setLoading(true);\r\n        const data = await apiMethods.get<ReplayResponse>(\"/aiops/remediation-log\");\r\n        if (data.success) {\r\n          setEvents(data.events);\r\n        }\r\n      } catch (err) {\r\n        setError(getErrorMessage(err));\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    fetchData();\r\n    // Refresh every 30 seconds\r\n    const intervalId = setInterval(fetchData, 30000);\r\n    return () => clearInterval(intervalId);\r\n  }, []);\r\n\r\n  const getSeverityColor = (severity: string) => {\r\n    switch (severity) {\r\n      case \"high\":\r\n        return \"text-red-600 bg-red-100\";\r\n      case \"medium\":\r\n        return \"text-orange-600 bg-orange-100\";\r\n      case \"low\":\r\n        return \"text-blue-600 bg-blue-100\";\r\n      default:\r\n        return \"text-gray-600 bg-gray-100\";\r\n    }\r\n  };\r\n\r\n  const getStatusIcon = (status: string) => {\r\n    switch (status) {\r\n      case \"executed\":\r\n        return \"‚úÖ\";\r\n      case \"pending\":\r\n        return \"‚è≥\";\r\n      case \"failed\":\r\n        return \"‚ùå\";\r\n      default:\r\n        return \"‚ùì\";\r\n    }\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"p-4 border rounded-lg bg-gray-50\">\r\n        <h2 className=\"font-bold text-lg mb-2\">Auto-Remediation Replay</h2>\r\n        <p className=\"text-gray-500\">Loading...</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (error) {\r\n    return (\r\n      <div className=\"p-4 border rounded-lg bg-red-50\">\r\n        <h2 className=\"font-bold text-lg mb-2\">Auto-Remediation Replay</h2>\r\n        <p className=\"text-red-600\">Error: {error}</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"p-4 border rounded-lg bg-white\">\r\n      <div className=\"flex items-center justify-between mb-4\">\r\n        <h2 className=\"font-bold text-lg\">Auto-Remediation Replay</h2>\r\n        {events.length > 0 && (\r\n          <span className=\"text-sm text-gray-500\">\r\n            {events.length} {events.length === 1 ? \"event\" : \"events\"}\r\n          </span>\r\n        )}\r\n      </div>\r\n\r\n      {events.length === 0 ? (\r\n        <p className=\"text-gray-500\">No remediation actions logged.</p>\r\n      ) : (\r\n        <div className=\"space-y-2 max-h-96 overflow-y-auto\">\r\n          {events.map((event, i) => (\r\n            <div\r\n              key={i}\r\n              className=\"border-b py-2 last:border-b-0 hover:bg-gray-50 transition-colors\"\r\n            >\r\n              <div className=\"flex items-start justify-between gap-2\">\r\n                <div className=\"flex-1\">\r\n                  <div className=\"flex items-center gap-2 mb-1\">\r\n                    <span className=\"text-sm\">\r\n                      {new Date(event.timestamp).toLocaleTimeString()}\r\n                    </span>\r\n                    <span\r\n                      className={`px-2 py-0.5 rounded text-xs font-medium ${getSeverityColor(\r\n                        event.severity\r\n                      )}`}\r\n                    >\r\n                      {event.severity.toUpperCase()}\r\n                    </span>\r\n                    <span className=\"text-lg\">{getStatusIcon(event.status)}</span>\r\n                  </div>\r\n                  <p className=\"text-sm\">\r\n                    <b className=\"text-gray-900\">{event.metric}</b>: {event.action}\r\n                  </p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AACA;AACA;AAFA;;;;AAkBe,SAAS;IACtB,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,6NAAQ,EAAqB,EAAE;IAC3D,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,6NAAQ,EAAC;IACvC,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,6NAAQ,EAAgB;IAElD,IAAA,8NAAS,EAAC;QACR,MAAM,YAAY;YAChB,IAAI;gBACF,WAAW;gBACX,MAAM,OAAO,MAAM,8IAAU,CAAC,GAAG,CAAiB;gBAClD,IAAI,KAAK,OAAO,EAAE;oBAChB,UAAU,KAAK,MAAM;gBACvB;YACF,EAAE,OAAO,KAAK;gBACZ,SAAS,IAAA,mJAAe,EAAC;YAC3B,SAAU;gBACR,WAAW;YACb;QACF;QAEA;QACA,2BAA2B;QAC3B,MAAM,aAAa,YAAY,WAAW;QAC1C,OAAO,IAAM,cAAc;IAC7B,GAAG,EAAE;IAEL,MAAM,mBAAmB,CAAC;QACxB,OAAQ;YACN,KAAK;gBACH,OAAO;YACT,KAAK;gBACH,OAAO;YACT,KAAK;gBACH,OAAO;YACT;gBACE,OAAO;QACX;IACF;IAEA,MAAM,gBAAgB,CAAC;QACrB,OAAQ;YACN,KAAK;gBACH,OAAO;YACT,KAAK;gBACH,OAAO;YACT,KAAK;gBACH,OAAO;YACT;gBACE,OAAO;QACX;IACF;IAEA,IAAI,SAAS;QACX,qBACE,0PAAC;YAAI,WAAU;;8BACb,0PAAC;oBAAG,WAAU;8BAAyB;;;;;;8BACvC,0PAAC;oBAAE,WAAU;8BAAgB;;;;;;;;;;;;IAGnC;IAEA,IAAI,OAAO;QACT,qBACE,0PAAC;YAAI,WAAU;;8BACb,0PAAC;oBAAG,WAAU;8BAAyB;;;;;;8BACvC,0PAAC;oBAAE,WAAU;;wBAAe;wBAAQ;;;;;;;;;;;;;IAG1C;IAEA,qBACE,0PAAC;QAAI,WAAU;;0BACb,0PAAC;gBAAI,WAAU;;kCACb,0PAAC;wBAAG,WAAU;kCAAoB;;;;;;oBACjC,OAAO,MAAM,GAAG,mBACf,0PAAC;wBAAK,WAAU;;4BACb,OAAO,MAAM;4BAAC;4BAAE,OAAO,MAAM,KAAK,IAAI,UAAU;;;;;;;;;;;;;YAKtD,OAAO,MAAM,KAAK,kBACjB,0PAAC;gBAAE,WAAU;0BAAgB;;;;;qCAE7B,0PAAC;gBAAI,WAAU;0BACZ,OAAO,GAAG,CAAC,CAAC,OAAO,kBAClB,0PAAC;wBAEC,WAAU;kCAEV,cAAA,0PAAC;4BAAI,WAAU;sCACb,cAAA,0PAAC;gCAAI,WAAU;;kDACb,0PAAC;wCAAI,WAAU;;0DACb,0PAAC;gDAAK,WAAU;0DACb,IAAI,KAAK,MAAM,SAAS,EAAE,kBAAkB;;;;;;0DAE/C,0PAAC;gDACC,WAAW,CAAC,wCAAwC,EAAE,iBACpD,MAAM,QAAQ,GACb;0DAEF,MAAM,QAAQ,CAAC,WAAW;;;;;;0DAE7B,0PAAC;gDAAK,WAAU;0DAAW,cAAc,MAAM,MAAM;;;;;;;;;;;;kDAEvD,0PAAC;wCAAE,WAAU;;0DACX,0PAAC;gDAAE,WAAU;0DAAiB,MAAM,MAAM;;;;;;4CAAK;4CAAG,MAAM,MAAM;;;;;;;;;;;;;;;;;;uBAnB/D;;;;;;;;;;;;;;;;AA6BnB","debugId":null}},
    {"offset": {"line": 1123, "column": 0}, "map": {"version":3,"sources":["file:///C:/desesonpro/desewebv5/frontend/src/components/aiops/SystemHealthPanel.tsx"],"sourcesContent":["\"use client\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { apiMethods, getErrorMessage } from \"@/api/client\";\r\n\r\ninterface HealthData {\r\n  status: \"healthy\" | \"unhealthy\";\r\n  timestamp: string;\r\n  uptime: number;\r\n  version: string;\r\n  environment: string;\r\n  database: \"connected\" | \"disconnected\";\r\n  memory: {\r\n    used: number;\r\n    total: number;\r\n  };\r\n  services: {\r\n    database: boolean;\r\n    redis: boolean;\r\n    openai: boolean;\r\n    lighthouse: boolean;\r\n  };\r\n}\r\n\r\nexport default function SystemHealthPanel() {\r\n  const [healthData, setHealthData] = useState<HealthData | null>(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  useEffect(() => {\r\n    const fetchData = async () => {\r\n      try {\r\n        setLoading(true);\r\n        // Health endpoint is at /health (not /api/v1/health)\r\n        const baseUrl = process.env.NEXT_PUBLIC_API_URL || 'http://localhost:3001';\r\n        const response = await fetch(`${baseUrl}/health`, {\r\n          credentials: 'include',\r\n          headers: {\r\n            'Authorization': `Bearer ${localStorage.getItem('token') || ''}`,\r\n          },\r\n        });\r\n        if (!response.ok) {\r\n          throw new Error(`HTTP ${response.status}: ${response.statusText}`);\r\n        }\r\n        const data = await response.json() as HealthData;\r\n        setHealthData(data);\r\n        setError(null);\r\n      } catch (err) {\r\n        setError(getErrorMessage(err));\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    // Initial fetch\r\n    fetchData();\r\n\r\n    // Poll every 30 seconds\r\n    const intervalId = setInterval(fetchData, 30000);\r\n\r\n    return () => clearInterval(intervalId);\r\n  }, []);\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"p-4 rounded bg-white border-2 border-gray-200 animate-pulse\">\r\n        <h2 className=\"font-bold text-lg mb-2\">System Health</h2>\r\n        <p className=\"text-gray-500\">Loading...</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (error) {\r\n    return (\r\n      <div className=\"p-4 rounded bg-red-50 border-2 border-red-300\">\r\n        <h2 className=\"font-bold text-lg mb-2\">System Health</h2>\r\n        <p className=\"text-red-600\">Error: {error}</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (!healthData) {\r\n    return (\r\n      <div className=\"p-4 rounded bg-white border-2 border-gray-200\">\r\n        <h2 className=\"font-bold text-lg mb-2\">System Health</h2>\r\n        <p className=\"text-gray-500\">No data available</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // Ensure services object exists with defaults (in case of error response)\r\n  const services = healthData.services || {\r\n    database: false,\r\n    redis: false,\r\n    openai: false,\r\n    lighthouse: false,\r\n  };\r\n\r\n  const isHealthy = healthData.status === \"healthy\";\r\n  const memoryUsagePercent = Math.round(\r\n    (healthData.memory.used / healthData.memory.total) * 100\r\n  );\r\n\r\n  const formatUptime = (seconds: number): string => {\r\n    const days = Math.floor(seconds / 86400);\r\n    const hours = Math.floor((seconds % 86400) / 3600);\r\n    const minutes = Math.floor((seconds % 3600) / 60);\r\n    \r\n    if (days > 0) {\r\n      return `${days}d ${hours}h ${minutes}m`;\r\n    } else if (hours > 0) {\r\n      return `${hours}h ${minutes}m`;\r\n    } else {\r\n      return `${minutes}m`;\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div\r\n      className={`p-4 rounded border-2 ${\r\n        isHealthy\r\n          ? \"bg-green-50 border-green-300\"\r\n          : \"bg-red-50 border-red-300\"\r\n      }`}\r\n    >\r\n      <div className=\"flex items-center justify-between mb-4\">\r\n        <div>\r\n          <h2 className=\"font-bold text-lg\">System Health</h2>\r\n          <p\r\n            className={`font-semibold text-sm ${\r\n              isHealthy ? \"text-green-700\" : \"text-red-700\"\r\n            }`}\r\n          >\r\n            {isHealthy ? \"‚úÖ All Systems Operational\" : \"‚ö†Ô∏è System Issues Detected\"}\r\n          </p>\r\n        </div>\r\n        <span className=\"text-2xl\">{isHealthy ? \"‚úÖ\" : \"‚ö†Ô∏è\"}</span>\r\n      </div>\r\n\r\n      <div className=\"space-y-3 text-sm\">\r\n        {/* Services Status */}\r\n        <div>\r\n          <p className=\"font-semibold text-gray-700 mb-2\">Services:</p>\r\n          <div className=\"grid grid-cols-2 gap-2\">\r\n            <div className=\"flex items-center gap-2\">\r\n              <span className={services.database ? \"text-green-600\" : \"text-red-600\"}>\r\n                {services.database ? \"‚úÖ\" : \"‚ùå\"}\r\n              </span>\r\n              <span className=\"text-gray-600\">Database</span>\r\n            </div>\r\n            <div className=\"flex items-center gap-2\">\r\n              <span className={services.redis ? \"text-green-600\" : \"text-red-600\"}>\r\n                {services.redis ? \"‚úÖ\" : \"‚ùå\"}\r\n              </span>\r\n              <span className=\"text-gray-600\">Redis</span>\r\n            </div>\r\n            <div className=\"flex items-center gap-2\">\r\n              <span className={services.openai ? \"text-green-600\" : \"text-red-600\"}>\r\n                {services.openai ? \"‚úÖ\" : \"‚ùå\"}\r\n              </span>\r\n              <span className=\"text-gray-600\">OpenAI</span>\r\n            </div>\r\n            <div className=\"flex items-center gap-2\">\r\n              <span className={services.lighthouse ? \"text-green-600\" : \"text-red-600\"}>\r\n                {services.lighthouse ? \"‚úÖ\" : \"‚ùå\"}\r\n              </span>\r\n              <span className=\"text-gray-600\">Lighthouse</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Memory Usage */}\r\n        <div>\r\n          <div className=\"flex justify-between items-center mb-1\">\r\n            <span className=\"font-semibold text-gray-700\">Memory:</span>\r\n            <span className=\"text-gray-600\">{memoryUsagePercent}%</span>\r\n          </div>\r\n          <div className=\"w-full bg-gray-200 rounded-full h-2\">\r\n            <div\r\n              className={`h-2 rounded-full ${\r\n                memoryUsagePercent > 80\r\n                  ? \"bg-red-500\"\r\n                  : memoryUsagePercent > 60\r\n                  ? \"bg-yellow-500\"\r\n                  : \"bg-green-500\"\r\n              }`}\r\n              style={{ width: `${memoryUsagePercent}%` }}\r\n            />\r\n          </div>\r\n          <div className=\"flex justify-between text-xs text-gray-500 mt-1\">\r\n            <span>{healthData.memory.used} MB</span>\r\n            <span>{healthData.memory.total} MB</span>\r\n          </div>\r\n        </div>\r\n\r\n        {/* System Info */}\r\n        <div className=\"space-y-1 pt-2 border-t border-gray-300\">\r\n          <div className=\"flex justify-between\">\r\n            <span className=\"text-gray-600\">Uptime:</span>\r\n            <span className=\"font-mono text-xs\">{formatUptime(healthData.uptime)}</span>\r\n          </div>\r\n          <div className=\"flex justify-between\">\r\n            <span className=\"text-gray-600\">Version:</span>\r\n            <span className=\"font-mono text-xs\">{healthData.version}</span>\r\n          </div>\r\n          <div className=\"flex justify-between\">\r\n            <span className=\"text-gray-600\">Environment:</span>\r\n            <span className=\"font-mono text-xs uppercase\">{healthData.environment}</span>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Last Update */}\r\n        <div className=\"text-xs text-gray-500 mt-2 pt-2 border-t border-gray-300\">\r\n          <span>Last update: {new Date(healthData.timestamp).toLocaleTimeString()}</span>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1645, "column": 0}, "map": {"version":3,"sources":["file:///C:/desesonpro/desewebv5/frontend/src/components/aiops/PerformanceMetricsPanel.tsx"],"sourcesContent":["\"use client\";\r\nimport { useEffect, useState } from \"react\";\r\nimport { api, getErrorMessage } from \"@/api/client\";\r\n\r\ninterface MetricData {\r\n  name: string;\r\n  value: number;\r\n  labels?: Record<string, string>;\r\n}\r\n\r\ninterface PerformanceData {\r\n  httpRequests: {\r\n    total: number;\r\n    inProgress: number;\r\n    avgDuration: number;\r\n  };\r\n  system: {\r\n    cpuUsage?: number;\r\n    memoryUsage?: number;\r\n    nodejsMemoryUsage?: number;\r\n  };\r\n  database: {\r\n    activeConnections: number;\r\n  };\r\n  seo: {\r\n    analysisTotal: number;\r\n    contentGenerationTotal: number;\r\n    alertsTotal: number;\r\n  };\r\n}\r\n\r\nexport default function PerformanceMetricsPanel() {\r\n  const [metrics, setMetrics] = useState<PerformanceData | null>(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  useEffect(() => {\r\n    const fetchData = async () => {\r\n      try {\r\n        setLoading(true);\r\n        // Metrics endpoint is at /metrics (not /api/v1/metrics)\r\n        const baseUrl = process.env.NEXT_PUBLIC_API_URL || 'http://localhost:3001';\r\n        const response = await fetch(`${baseUrl}/metrics`, {\r\n          credentials: 'include',\r\n          headers: {\r\n            'Authorization': `Bearer ${localStorage.getItem('token') || ''}`,\r\n          },\r\n        });\r\n        if (!response.ok) {\r\n          throw new Error(`HTTP ${response.status}: ${response.statusText}`);\r\n        }\r\n        const text = await response.text();\r\n        const parsedMetrics = parsePrometheusMetrics(text);\r\n        setMetrics(parsedMetrics);\r\n        setError(null);\r\n      } catch (err) {\r\n        setError(getErrorMessage(err));\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    // Initial fetch\r\n    fetchData();\r\n\r\n    // Poll every 15 seconds (metrics update more frequently)\r\n    const intervalId = setInterval(fetchData, 15000);\r\n\r\n    return () => clearInterval(intervalId);\r\n  }, []);\r\n\r\n  const parsePrometheusMetrics = (text: string): PerformanceData => {\r\n    const lines = text.split(\"\\n\").filter((line) => line && !line.startsWith(\"#\"));\r\n    \r\n    const data: PerformanceData = {\r\n      httpRequests: {\r\n        total: 0,\r\n        inProgress: 0,\r\n        avgDuration: 0,\r\n      },\r\n      system: {},\r\n      database: {\r\n        activeConnections: 0,\r\n      },\r\n      seo: {\r\n        analysisTotal: 0,\r\n        contentGenerationTotal: 0,\r\n        alertsTotal: 0,\r\n      },\r\n    };\r\n\r\n    let totalDuration = 0;\r\n    let durationCount = 0;\r\n\r\n    lines.forEach((line) => {\r\n      // HTTP Requests Total\r\n      if (line.startsWith(\"http_requests_total\")) {\r\n        const match = line.match(/http_requests_total\\{[^}]*\\}\\s+(\\d+)/);\r\n        if (match) {\r\n          data.httpRequests.total += parseFloat(match[1]);\r\n        }\r\n      }\r\n\r\n      // HTTP Requests In Progress\r\n      if (line.startsWith(\"http_requests_in_progress\")) {\r\n        const match = line.match(/http_requests_in_progress\\{[^}]*\\}\\s+(\\d+)/);\r\n        if (match) {\r\n          data.httpRequests.inProgress += parseFloat(match[1]);\r\n        }\r\n      }\r\n\r\n      // HTTP Request Duration\r\n      if (line.startsWith(\"http_request_duration_seconds\")) {\r\n        const match = line.match(/http_request_duration_seconds\\{[^}]*\\}\\s+([\\d.]+)/);\r\n        if (match) {\r\n          totalDuration += parseFloat(match[1]);\r\n          durationCount++;\r\n        }\r\n      }\r\n\r\n      // Database Connections\r\n      if (line.startsWith(\"database_connections_active\")) {\r\n        const match = line.match(/database_connections_active\\s+(\\d+)/);\r\n        if (match) {\r\n          data.database.activeConnections = parseFloat(match[1]);\r\n        }\r\n      }\r\n\r\n      // System Memory (Node.js)\r\n      if (line.startsWith(\"process_resident_memory_bytes\")) {\r\n        const match = line.match(/process_resident_memory_bytes\\s+(\\d+)/);\r\n        if (match) {\r\n          data.system.memoryUsage = parseFloat(match[1]) / 1024 / 1024; // Convert to MB\r\n        }\r\n      }\r\n\r\n      // SEO Metrics\r\n      if (line.startsWith(\"seo_analysis_total\")) {\r\n        const match = line.match(/seo_analysis_total\\{[^}]*\\}\\s+(\\d+)/);\r\n        if (match) {\r\n          data.seo.analysisTotal += parseFloat(match[1]);\r\n        }\r\n      }\r\n\r\n      if (line.startsWith(\"content_generation_total\")) {\r\n        const match = line.match(/content_generation_total\\{[^}]*\\}\\s+(\\d+)/);\r\n        if (match) {\r\n          data.seo.contentGenerationTotal += parseFloat(match[1]);\r\n        }\r\n      }\r\n\r\n      if (line.startsWith(\"seo_alerts_total\")) {\r\n        const match = line.match(/seo_alerts_total\\{[^}]*\\}\\s+(\\d+)/);\r\n        if (match) {\r\n          data.seo.alertsTotal += parseFloat(match[1]);\r\n        }\r\n      }\r\n    });\r\n\r\n    // Calculate average duration\r\n    if (durationCount > 0) {\r\n      data.httpRequests.avgDuration = totalDuration / durationCount;\r\n    }\r\n\r\n    return data;\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"p-4 rounded bg-white border-2 border-gray-200 animate-pulse\">\r\n        <h2 className=\"font-bold text-lg mb-2\">Performance Metrics</h2>\r\n        <p className=\"text-gray-500\">Loading...</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (error) {\r\n    return (\r\n      <div className=\"p-4 rounded bg-red-50 border-2 border-red-300\">\r\n        <h2 className=\"font-bold text-lg mb-2\">Performance Metrics</h2>\r\n        <p className=\"text-red-600\">Error: {error}</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (!metrics) {\r\n    return (\r\n      <div className=\"p-4 rounded bg-white border-2 border-gray-200\">\r\n        <h2 className=\"font-bold text-lg mb-2\">Performance Metrics</h2>\r\n        <p className=\"text-gray-500\">No data available</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"p-4 rounded bg-white border-2 border-blue-200 bg-blue-50\">\r\n      <div className=\"flex items-center justify-between mb-4\">\r\n        <div>\r\n          <h2 className=\"font-bold text-lg\">Performance Metrics</h2>\r\n          <p className=\"text-blue-700 text-sm font-semibold\">Real-time Monitoring</p>\r\n        </div>\r\n        <span className=\"text-2xl\">üìä</span>\r\n      </div>\r\n\r\n      <div className=\"space-y-4 text-sm\">\r\n        {/* HTTP Requests */}\r\n        <div>\r\n          <p className=\"font-semibold text-gray-700 mb-2\">HTTP Requests:</p>\r\n          <div className=\"space-y-2\">\r\n            <div className=\"flex justify-between items-center\">\r\n              <span className=\"text-gray-600\">Total Requests:</span>\r\n              <span className=\"font-mono font-semibold\">{metrics.httpRequests.total.toLocaleString()}</span>\r\n            </div>\r\n            <div className=\"flex justify-between items-center\">\r\n              <span className=\"text-gray-600\">In Progress:</span>\r\n              <span\r\n                className={`font-mono font-semibold ${\r\n                  metrics.httpRequests.inProgress > 10 ? \"text-orange-600\" : \"text-green-600\"\r\n                }`}\r\n              >\r\n                {metrics.httpRequests.inProgress}\r\n              </span>\r\n            </div>\r\n            <div className=\"flex justify-between items-center\">\r\n              <span className=\"text-gray-600\">Avg Duration:</span>\r\n              <span className=\"font-mono font-semibold\">\r\n                {(metrics.httpRequests.avgDuration * 1000).toFixed(2)}ms\r\n              </span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Database */}\r\n        <div className=\"pt-2 border-t border-gray-300\">\r\n          <p className=\"font-semibold text-gray-700 mb-2\">Database:</p>\r\n          <div className=\"flex justify-between items-center\">\r\n            <span className=\"text-gray-600\">Active Connections:</span>\r\n            <span\r\n              className={`font-mono font-semibold ${\r\n                metrics.database.activeConnections > 50\r\n                  ? \"text-red-600\"\r\n                  : metrics.database.activeConnections > 20\r\n                  ? \"text-orange-600\"\r\n                  : \"text-green-600\"\r\n              }`}\r\n            >\r\n              {metrics.database.activeConnections}\r\n            </span>\r\n          </div>\r\n        </div>\r\n\r\n        {/* SEO Metrics */}\r\n        <div className=\"pt-2 border-t border-gray-300\">\r\n          <p className=\"font-semibold text-gray-700 mb-2\">SEO Operations:</p>\r\n          <div className=\"space-y-1\">\r\n            <div className=\"flex justify-between items-center\">\r\n              <span className=\"text-gray-600\">Analyses:</span>\r\n              <span className=\"font-mono text-xs\">{metrics.seo.analysisTotal.toLocaleString()}</span>\r\n            </div>\r\n            <div className=\"flex justify-between items-center\">\r\n              <span className=\"text-gray-600\">Content Generated:</span>\r\n              <span className=\"font-mono text-xs\">{metrics.seo.contentGenerationTotal.toLocaleString()}</span>\r\n            </div>\r\n            <div className=\"flex justify-between items-center\">\r\n              <span className=\"text-gray-600\">Alerts:</span>\r\n              <span className=\"font-mono text-xs\">{metrics.seo.alertsTotal.toLocaleString()}</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* System Memory */}\r\n        {metrics.system.memoryUsage && (\r\n          <div className=\"pt-2 border-t border-gray-300\">\r\n            <p className=\"font-semibold text-gray-700 mb-2\">System:</p>\r\n            <div className=\"flex justify-between items-center\">\r\n              <span className=\"text-gray-600\">Memory:</span>\r\n              <span className=\"font-mono text-xs\">{metrics.system.memoryUsage.toFixed(2)} MB</span>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Last Update */}\r\n        <div className=\"text-xs text-gray-500 mt-2 pt-2 border-t border-gray-300\">\r\n          <span>Updated: {new Date().toLocaleTimeString()}</span>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n"],"names":[],"mappings":"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","debugId":null}}]
}